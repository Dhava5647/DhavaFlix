<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DhavaFlix</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .scrollbar-hide::-webkit-scrollbar { display: none; }
    .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body class="bg-black text-white">
  <!-- Navbar -->
  <header class="flex items-center justify-between p-4 bg-black fixed w-full z-50">
    <h1 class="text-2xl font-bold text-red-600">DhavaFlix</h1>
    <nav class="space-x-4">
      <a href="#" class="hover:text-red-500">Home</a>
      <a href="#" class="hover:text-red-500">Movies</a>
      <a href="#" class="hover:text-red-500">Series</a>
    </nav>
  </header>

  <!-- Hero Section -->
  <section class="h-[60vh] bg-cover bg-center flex items-center justify-center text-center"
           style="background-image: url('https://placehold.co/1600x600/101010/FFFFFF?text=DhavaFlix+Hero');">
    <div class="bg-black/50 p-6 rounded-lg">
      <h2 class="text-3xl font-bold mb-2">Welcome to DhavaFlix</h2>
      <p class="mb-4">Stream your favorite Movies & Webseries anytime!</p>
      <button class="bg-red-600 px-4 py-2 rounded-lg hover:bg-red-700">Watch Now</button>
    </div>
  </section>

  <!-- Movies Container -->
  <main id="movies-container" class="p-4 mt-8"></main>

  <!-- Movie Modal -->
  <div id="movie-modal" class="fixed inset-0 bg-black/80 flex items-center justify-center hidden z-50">
    <div class="bg-gray-900 rounded-lg max-w-lg w-full p-4 relative">
      <button id="close-modal" class="absolute top-2 right-2 text-gray-400 hover:text-white text-2xl">&times;</button>
      <img id="modal-poster" src="" alt="" class="w-full h-80 object-cover rounded-lg mb-4">
      <h2 id="modal-title" class="text-2xl font-bold mb-2"></h2>
      <p id="modal-info" class="text-gray-400 text-sm mb-2"></p>
      <p id="modal-rating" class="text-yellow-400 font-semibold mb-2"></p>
      <p id="modal-plot" class="text-sm mb-4"></p>
      <button id="trailer-btn" class="bg-red-600 px-4 py-2 rounded-lg hover:bg-red-700 w-full mb-4">▶ Watch Trailer</button>
      <!-- Embedded YouTube Player -->
      <div id="trailer-container" class="hidden">
        <iframe id="trailer-frame" width="100%" height="315" class="rounded-lg"
                src="" title="YouTube trailer" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe>
      </div>
    </div>
  </div>

  <!-- Script -->
  <script>
    const apiKey = "8fb22be"; // ✅ Your OMDb API key
    const moviesContainer = document.getElementById("movies-container");

    const modal = document.getElementById("movie-modal");
    const closeModal = document.getElementById("close-modal");
    const modalPoster = document.getElementById("modal-poster");
    const modalTitle = document.getElementById("modal-title");
    const modalInfo = document.getElementById("modal-info");
    const modalRating = document.getElementById("modal-rating");
    const modalPlot = document.getElementById("modal-plot");
    const trailerBtn = document.getElementById("trailer-btn");
    const trailerContainer = document.getElementById("trailer-container");
    const trailerFrame = document.getElementById("trailer-frame");

    let currentMovie = "";

    const categories = {
      "Trending Now": ["Kalki 2898 AD", "Jawan", "Oppenheimer", "RRR", "Barbie"],
      "Bollywood Hits": ["Pathaan", "War", "Gadar 2", "Dunki", "KGF"],
      "Hollywood Blockbusters": ["Avengers Endgame", "Batman", "Inception", "Fast and Furious", "Avatar"],
      "Action Packed": ["John Wick", "Pushpa", "Shershaah", "Extraction", "Mission Impossible"],
      "Comedy": ["Hera Pheri", "Welcome", "Phir Hera Pheri", "Golmaal", "Dhamaal"],
      "Sci-Fi Worlds": ["Interstellar", "Blade Runner 2049", "Star Wars", "The Matrix", "Tenet"],
      "Web Series": ["Mirzapur", "Sacred Games", "Stranger Things", "Money Heist", "Squid Game"],
      "Drama": ["Kabir Singh", "Tamasha", "La La Land", "A Star is Born", "Dangal"],
      "Horror": ["The Conjuring", "Annabelle", "Bhool Bhulaiyaa", "Stree", "Tumbbad"],
      "Romance": ["Dilwale Dulhania Le Jayenge", "Yeh Jawaani Hai Deewani", "Titanic", "Notebook", "The Fault in Our Stars"]
    };

    async function fetchMovie(title) {
      const res = await fetch(`https://www.omdbapi.com/?t=${encodeURIComponent(title)}&apikey=${apiKey}`);
      const data = await res.json();
      return data.Response === "True" ? data : null;
    }

    async function fetchYouTubeTrailer(query) {
      const searchUrl = `https://www.youtube.com/results?search_query=${encodeURIComponent(query + " official trailer")}`;
      // Trick: Use YouTube embed with first video id (static fallback for now)
      // For demo, we’ll just open search in embed with autoplay (works as preview)
      return `https://www.youtube.com/embed?listType=search&list=${encodeURIComponent(query + " official trailer")}&autoplay=1`;
    }

    async function displayCategory(categoryName, movieList) {
      const row = document.createElement("div");
      row.className = "mb-8";

      const heading = document.createElement("h2");
      heading.className = "text-xl font-bold mb-2 px-4";
      heading.textContent = categoryName;

      const scroll = document.createElement("div");
      scroll.className = "flex gap-4 overflow-x-scroll px-4 scrollbar-hide";

      row.appendChild(heading);
      row.appendChild(scroll);
      moviesContainer.appendChild(row);

      for (const title of movieList) {
        const data = await fetchMovie(title);
        if (data) {
          const card = document.createElement("div");
          card.className = "relative w-40 flex-shrink-0 group cursor-pointer";
          card.innerHTML = `
            <img src="${data.Poster !== "N/A" ? data.Poster : "https://placehold.co/400x600/101010/FFFFFF?text=No+Poster"}" 
                 alt="${data.Title}" 
                 class="w-full h-60 object-cover rounded-lg shadow-lg group-hover:scale-105 transition"
                 loading="lazy">
            <div class="absolute inset-0 flex items-center justify-center bg-black/40 opacity-0 group-hover:opacity-100 transition">
               <svg class="w-12 h-12 text-white" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M6 4l12 6-12 6V4z" />
               </svg>
            </div>
            <p class="mt-2 text-sm text-center">${data.Title}</p>
          `;

          // ✅ Click to open modal
          card.addEventListener("click", () => {
            modalPoster.src = data.Poster !== "N/A" ? data.Poster : "https://placehold.co/400x600/101010/FFFFFF?text=No+Poster";
            modalTitle.textContent = data.Title;
            modalInfo.textContent = `${data.Year} • ${data.Genre}`;
            modalRating.textContent = `⭐ IMDb: ${data.imdbRating}`;
            modalPlot.textContent = data.Plot;
            currentMovie = data.Title;
            trailerContainer.classList.add("hidden");
            trailerFrame.src = "";
            modal.classList.remove("hidden");
          });

          scroll.appendChild(card);
        }
      }
    }

    // Close modal
    closeModal.addEventListener("click", () => {
      modal.classList.add("hidden");
      trailerFrame.src = ""; // stop video
    });
    window.addEventListener("click", (e) => {
      if (e.target === modal) {
        modal.classList.add("hidden");
        trailerFrame.src = ""; // stop video
      }
    });

    // Trailer button
    trailerBtn.addEventListener("click", async () => {
      if (currentMovie) {
        const url = await fetchYouTubeTrailer(currentMovie);
        trailerFrame.src = url;
        trailerContainer.classList.remove("hidden");
        trailerBtn.textContent = "▶ Playing Trailer...";
      }
    });

    (async function init() {
      for (const [category, movies] of Object.entries(categories)) {
        await displayCategory(category, movies);
      }
    })();
  </script>
</body>
</html>
